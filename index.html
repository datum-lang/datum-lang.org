<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Charj</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/7b395bb9b8aaf1677a3d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7b395bb9b8aaf1677a3d.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-cc012b2e01d4498070bf.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.483e8dd6d267baea9145.js" as="script"/><link rel="preload" href="/_next/static/chunks/75d0fbb1153454ef8e9bfd327d44080552bdc54e.f4626cef716ce67a0fe6.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-a8b90a3cdbfa2866f49b.js" as="script"/><link rel="preload" href="/_next/static/chunks/9f1dc3fa6ebb549af7417cdbef76437df99013dc.cbcaf4c8961f33298072.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/index-b5e7fb573515c411b860.js" as="script"/></head><body><div id="__next"><div class="h-screen"><div class="bg-white"><div class="bg-gray-50 border-b border-gray-200"><div class="relative py-6"><nav class="mx-auto flex items-center justify-between px-4 sm:px-6 md:px-8 max-w-screen-lg lg:p-0"><a class="flex items-center" href="/"><img class="h-10 w-auto sm:h-12 my-2" src="https://raw.githubusercontent.com/charj-lang/arts/master/logo.svg" alt=""/><div class="ml-5 flex flex-col justify-center"><div class="font-bold text-gray-900 leading-tight text-2xl sm:text-3xl tracking-tight">Charj</div></div></a><div class="-mr-2 flex items-center lg:hidden"><button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out"><svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24"><title>Menu | Charj</title><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg></button></div><div class="hidden lg:flex md:ml-10 items-end"><a class="font-medium text-gray-500 hover:text-gray-900 transition duration-150 ease-in-out" href="/blog">Blog</a><a class="ml-10 font-medium text-gray-500 hover:text-gray-900 transition duration-150 ease-in-out" href="/docs">Docs</a><a href="https://github.com/charj-lang/charj" class="ml-10 text-gray-500 hover:text-gray-900 transition duration-150 ease-in-out" style="line-height:0"><span class="sr-only">GitHub</span><svg class="h-6 w-6 inline" fill="currentColor" viewBox="0 0 24 24"><title>Github | Deno</title><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg></a></div></nav></div><div class="max-w-screen-sm mx-auto px-4 sm:px-6 md:px-8 pt-12 pb-20 flex flex-col items-center"><h1 class="font-extrabold text-5xl leading-10 tracking-tight text-gray-900">Charj</h1><h2 class="mt-4 sm:mt-5 font-light text-2xl text-center leading-tight text-gray-900">Charj Lang 是一个使用<strong class="font-semibold">Rust</strong>编写的<strong class="font-semibold">描述式、中间</strong>编程语言</h2></div><div class="max-w-screen-sm mx-auto px-4 sm:px-6 md:px-8 mt-20"><div class="markdown py-8 px-4 "><h1 id="charj">Charj</h1>
<p>The home of the Charj website </p>
<p>Charj Lang 是一个使用 Rust 编写的<strong>描述式</strong>、<strong>中间</strong>编程语言。其主要用途是：</p>
<ul>
<li>legacy system migration.</li>
<li>domain model design for languages.</li>
<li>compile languages. for examples, JavaScript to WASM.<ul>
<li>visualize architecture.</li>
<li>a quick DSL maker&#39;s infrastructure. (TBD)</li>
</ul>
</li>
</ul>
<h2 id="compiler-workflow">Compiler Workflow</h2>
<pre><code class="language-python"><pre class="prism-code language-python flex overflow-y-auto" style="color:#393A34;background-color:#f6f8fa"><code><div class="token-line text-xs" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;hello world&#x27;</span><span class="token punctuation" style="color:#393A34">)</span></div></code></pre></code></pre>
<p>上下游支撑项目：</p>
<ol>
<li>语言转换：<a href="https://github.com/charj-lang/charj-poet">Charj Poet</a></li>
<li>IDEA 插件: <a href="https://github.com/charj-lang/intellij-charj">Intellij Charj</a></li>
<li>Charj 项目：<a href="https://github.com/charj-lang/charj">Charj</a></li>
<li>Scie 语言识别引擎：<a href="https://github.com/charj-lang/scie">Scie</a></li>
</ol>
<h3 id="total-compiler-flow">Total compiler flow</h3>
<pre><code class="language-step-line"><pre class="prism-code language-step-line flex overflow-y-auto" style="color:#393A34;background-color:#f6f8fa"><code><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - origin language</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Scie (tokenizer)</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Poet DSL 1</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Charj Poet</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Charj code (charj compiler)</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Poet DSL 2</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - Charj Lang Generate API</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"> - other language</span></div></code></pre></code></pre>
<h3 id="流程设计">流程设计</h3>
<h4 id="1-解析">1. 解析</h4>
<p>Visual Studio Code 使用 Textmate 的语法来解析不同的语言。如下的语言</p>
<pre><code class="language-c"><pre class="prism-code language-c flex overflow-y-auto" style="color:#393A34;background-color:#f6f8fa"><code><div class="token-line text-xs" style="color:#393A34"><span class="token macro property" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">\&quot;Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">\&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></code></pre>
<p>将会被解析为：</p>
<pre><code class="language-bash"><pre class="prism-code language-bash flex overflow-y-auto" style="color:#393A34;background-color:#f6f8fa"><code><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token comment" style="color:#999988;font-style:italic">#) with scopes C, meta.preprocessor.include.c, , punctuation.definition.directive.c</span><span class="token plain"></span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.preprocessor.include.c, </span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.preprocessor.include.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c, punctuation.definition.string.begin.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stdio.h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c, punctuation.definition.string.end.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, storage.type.built-in.primitive.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.function.c, meta.function.definition.parameters.c, entity.name.function.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> </span><span class="token variable punctuation" style="color:#393A34">((</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"> with scopes C</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function.definition.parameters.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> punctuation.section.parameters.begin.bracket.round.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa"> token from </span><span class="token variable number" style="color:#36acaa">9</span><span class="token variable" style="color:#36acaa"> to </span><span class="token variable number" style="color:#36acaa">10</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable punctuation" style="color:#393A34">))</span><span class="token plain"> with scopes C, meta.function.c, meta.function.definition.parameters.c, punctuation.section.parameters.end.bracket.round.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, punctuation.section.block.begin.bracket.curly.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">printf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, meta.function-call.c, entity.name.function.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token variable punctuation" style="color:#393A34">((</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"> with scopes C</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.block.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function</span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa">call.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> punctuation.section.arguments.begin.bracket.round.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa"> token from </span><span class="token variable number" style="color:#36acaa">7</span><span class="token variable" style="color:#36acaa"> to </span><span class="token variable number" style="color:#36acaa">8</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">&quot;</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"> with scopes C</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.block.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function</span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa">call.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> string.quoted.double.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> punctuation.definition.string.begin.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa"> token from </span><span class="token variable number" style="color:#36acaa">8</span><span class="token variable" style="color:#36acaa"> to </span><span class="token variable number" style="color:#36acaa">21</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">Hello</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> World</span><span class="token variable operator" style="color:#393A34">!</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"> with scopes C</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.block.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function</span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa">call.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> string.quoted.double.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa"> token from </span><span class="token variable number" style="color:#36acaa">21</span><span class="token variable" style="color:#36acaa"> to </span><span class="token variable number" style="color:#36acaa">22</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">&quot;</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"> with scopes C</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.block.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> meta.function</span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa">call.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> string.quoted.double.c</span><span class="token variable punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa"> punctuation.definition.string.end.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">-</span><span class="token variable" style="color:#36acaa"> token from </span><span class="token variable number" style="color:#36acaa">22</span><span class="token variable" style="color:#36acaa"> to </span><span class="token variable number" style="color:#36acaa">23</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable punctuation" style="color:#393A34">))</span><span class="token plain"> with scopes C, meta.block.c, meta.function-call.c, punctuation.section.arguments.end.bracket.round.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, punctuation.terminator.statement.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">return</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, keyword.control.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, constant.numeric.decimal.c</span></div><div class="token-line text-xs" style="color:#393A34"><span class="token plain">- token from </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> with scopes C, meta.block.c, punctuation.terminator.statement.c</span></div></code></pre></code></pre>
<p>从这一步，我们可以拿到一个 Tokenizer 后的结果，如我们 include 的情况等等。</p>
<h4 id="2-dsl-转换">2. DSL 转换</h4>
<p>随后，我们要将上述的 Token 进行转换，转换到特定的 DSL，这里暂时称之为 Translator DSL。</p>
<p>Translator DSL 将映射到 Poet DSL 上。</p>
<h4 id="3-生成-charj-代码">3. 生成 Charj 代码</h4>
<p>即，代码中的：<a href="https://github.com/charj-lang/charj-poet">https://github.com/charj-lang/charj-poet</a></p>
<h4 id="4-charj-编辑与代码优化">4. Charj 编辑与代码优化</h4>
<p><a href="https://github.com/charj-lang/charj">https://github.com/charj-lang/charj</a></p>
<h4 id="5-再次转换">5. 再次转换</h4>
<p>理想情况下，通过我们的 Translator DSL，就可以再度将代码转换为新的语言。</p>
<p><img src="https://github.com/charj-lang/arts/blob/master/charj-process.png?raw=true" alt="流程图"></p>
<h2 id="related">Related</h2>
<p><a href="https://github.com/usethesource/rascal">https://github.com/usethesource/rascal</a> is a meta-programming language. It contains the interpreter, the parser generator, the parser run-time, the standard library, the online documentation and the type checker.</p>
<h2 id="faq">FAQ</h2>
<h3 id="如何支持内置函数？">如何支持内置函数？</h3>
<p>来源：内置函数你怎么搞，比如打开文件 Python 是 Open，C++ 是 Stream，API 都不一样？</p>
<p>Charj 并不会支持内置函数的转换。 Charj 关心的是语言的互转，可以简单的认为 AST 的互转，不考虑编译等场景。</p>
<p>对应未来可能的支持方案：对内置函数进行接口封装，等转换到新语言后，再由开发者实现这些接口。</p>
<h3 id="是否实现虚拟机？">是否实现虚拟机？</h3>
<p>需要等到有精力的时间再考虑。</p>
<h3 id="c-的支持程度？">C++ 的支持程度？</h3>
<p>C++ 过于复杂，未来只会出现有限的 C++ 支持。</p>
<h3 id="go-context？">Go Context？</h3>
<p>是否要实现一些库去模拟 Context 的 Timeout Cancel？</p>
<h3 id="ebnf">EBNF</h3>
<h3 id="其它-suggestions">其它 Suggestions</h3>
<h4 id="notes">Notes</h4>
<p>from <a href="https://www.zhihu.com/people/yunlongyun">雾色</a></p>
<blockquote>
<p>为什么要编程语言转编程语言呢？如果可以从伪代码快速转化成编程语言不是也可以吗？并且这种抽象层次是比较稳定的。我们缺少伪代码转换成任何编程语言的工具。就像智能提示，我们可以把伪代码分解成细粒度，每个伪代码的名词都可以在网络库中找到对象，动词有方法，形容词有属性，再通过逻辑组织起来，每个细粒度的对象和逻辑都能被转换成任何编程语言。</p>
</blockquote>
<blockquote>
<p>我的意思是建立通用语言的标准，并尝试建立其中一门主流语言的对象库，甚至是脱离对象的通用方法和通用属性，在类似vscode这种编辑器中提供伪代码到对象或者函数的接口，每个人都能发布他的一个函数、一个对象、一个通用方法、一个通用属性到这个网络上的平台，其它人写伪代码时就可以直接提示出他选择的语言相关的对象、函数或者方法了。这样算不算实现了跨语言呢。把语言转换留给编程者去做，而这边只是提供一个平台、标准、接口或者编辑器插件。就像超强的tabnine。</p>
</blockquote>
<blockquote>
<p>可以把你伪代码中的任意一个词，给出许多（开源实时添加的）智能提示，比如我要实现一个算法，让篮子里的苹果增加一个。
通过nlp分词并解析出词性，再给出对应的提示，篮子、苹果的对象，增加这个方法，一个这个数词可能是调用方法的循环次数。到最后自己需要的是组织，并且实现网络提示接口中没有的对象和方法，并自动上传。粒度可以是自由的，可以实现一个复杂的功能，可以实现一个简单点方法。将这种方法按照业务领域或者主题来划分。</p>
</blockquote>
<p>from <a href="https://www.zhihu.com/people/ling-jian-94">灵剑</a></p>
<blockquote>
<p>简单听完有一些很深切的疑问：1. 不同语言的解析模型就不一样，正则表达式解析语法树这样的想法会不会太naive了一点？比如说C++的语法纯粹就是上下文相关的，a&lt;b,c&gt;d这样的结构有多义性，不可能单纯通过文法变成语法树；再比如说Python的语法跟缩进层级是有关的。2. 能变成语法树不代表就能做相互转码，首先不同语言的功能不一样，虽然说图灵完备的语言原则上都可以相互表达，但是这个相互转化的过程本身可能代价会超乎想象，甚至不得不以某种类似于虚拟机解释执行的方式运行；其次，标准库差异的问题难以解决，操作系统API之类的更难。更不要说跟第三方库二进制连接的问题了。</p>
</blockquote>
</div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"intro":"\n# Charj\n\nThe home of the Charj website \n\nCharj Lang 是一个使用 Rust 编写的**描述式**、**中间**编程语言。其主要用途是：\n\n - legacy system migration.\n - domain model design for languages.\n - compile languages. for examples, JavaScript to WASM.\n     - visualize architecture.\n     - a quick DSL maker's infrastructure. (TBD)\n\n## Compiler Workflow\n\n```python\ndef hello():\n    print('hello world')\n```\n\n上下游支撑项目：\n\n1. 语言转换：[Charj Poet](https://github.com/charj-lang/charj-poet)\n2. IDEA 插件: [Intellij Charj](https://github.com/charj-lang/intellij-charj)\n3. Charj 项目：[Charj](https://github.com/charj-lang/charj)\n4. Scie 语言识别引擎：[Scie](https://github.com/charj-lang/scie)\n\n\n### Total compiler flow\n\n```step-line\n - origin language\n - Scie (tokenizer)\n - Poet DSL 1\n - Charj Poet\n - Charj code (charj compiler)\n - Poet DSL 2\n - Charj Lang Generate API\n - other language\n```\n\n### 流程设计\n\n#### 1. 解析\n\nVisual Studio Code 使用 Textmate 的语法来解析不同的语言。如下的语言\n\n```c\n#include \u003cstdio.h\u003e\nint main() {\n  printf(\\\"Hello, World!\\\");\n  return 0;\n}\n```\n\n将会被解析为：\n\n```bash\n- token from 0 to 1 () with scopes C\n- token from 0 to 1 (#) with scopes C, meta.preprocessor.include.c, , punctuation.definition.directive.c\n- token from 1 to 8 (include) with scopes C, meta.preprocessor.include.c, \n- token from 8 to 9 ( ) with scopes C, meta.preprocessor.include.c\n- token from 9 to 10 (\u003c) with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c, punctuation.definition.string.begin.c\n- token from 10 to 17 (stdio.h) with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c\n- token from 17 to 18 (\u003e) with scopes C, meta.preprocessor.include.c, string.quoted.other.lt-gt.include.c, punctuation.definition.string.end.c\n- token from 0 to 3 (int) with scopes C, storage.type.built-in.primitive.c\n- token from 3 to 4 ( ) with scopes C\n- token from 4 to 8 (main) with scopes C, meta.function.c, meta.function.definition.parameters.c, entity.name.function.c\n- token from 8 to 9 (() with scopes C, meta.function.c, meta.function.definition.parameters.c, punctuation.section.parameters.begin.bracket.round.c\n- token from 9 to 10 ()) with scopes C, meta.function.c, meta.function.definition.parameters.c, punctuation.section.parameters.end.bracket.round.c\n- token from 10 to 11 ( ) with scopes C\n- token from 11 to 12 ({) with scopes C, meta.block.c, punctuation.section.block.begin.bracket.curly.c\n- token from 0 to 6 (printf) with scopes C, meta.block.c, meta.function-call.c, entity.name.function.c\n- token from 6 to 7 (() with scopes C, meta.block.c, meta.function-call.c, punctuation.section.arguments.begin.bracket.round.c\n- token from 7 to 8 (\") with scopes C, meta.block.c, meta.function-call.c, string.quoted.double.c, punctuation.definition.string.begin.c\n- token from 8 to 21 (Hello, World!) with scopes C, meta.block.c, meta.function-call.c, string.quoted.double.c\n- token from 21 to 22 (\") with scopes C, meta.block.c, meta.function-call.c, string.quoted.double.c, punctuation.definition.string.end.c\n- token from 22 to 23 ()) with scopes C, meta.block.c, meta.function-call.c, punctuation.section.arguments.end.bracket.round.c\n- token from 23 to 24 (;) with scopes C, meta.block.c, punctuation.terminator.statement.c\n- token from 0 to 6 (return) with scopes C, meta.block.c, keyword.control.c\n- token from 6 to 7 ( ) with scopes C, meta.block.c\n- token from 7 to 8 (0) with scopes C, meta.block.c, constant.numeric.decimal.c\n- token from 8 to 9 (;) with scopes C, meta.block.c, punctuation.terminator.statement.c\n```\n\n从这一步，我们可以拿到一个 Tokenizer 后的结果，如我们 include 的情况等等。\n\n#### 2. DSL 转换\n\n随后，我们要将上述的 Token 进行转换，转换到特定的 DSL，这里暂时称之为 Translator DSL。\n\nTranslator DSL 将映射到 Poet DSL 上。\n\n#### 3. 生成 Charj 代码\n\n即，代码中的：https://github.com/charj-lang/charj-poet\n\n#### 4. Charj 编辑与代码优化\n\n[https://github.com/charj-lang/charj](https://github.com/charj-lang/charj)\n\n#### 5. 再次转换\n\n理想情况下，通过我们的 Translator DSL，就可以再度将代码转换为新的语言。\n\n![流程图](https://github.com/charj-lang/arts/blob/master/charj-process.png?raw=true)\n\n## Related\n\n[https://github.com/usethesource/rascal](https://github.com/usethesource/rascal) is a meta-programming language. It contains the interpreter, the parser generator, the parser run-time, the standard library, the online documentation and the type checker.\n\n## FAQ\n\n### 如何支持内置函数？\n\n来源：内置函数你怎么搞，比如打开文件 Python 是 Open，C++ 是 Stream，API 都不一样？\n\nCharj 并不会支持内置函数的转换。 Charj 关心的是语言的互转，可以简单的认为 AST 的互转，不考虑编译等场景。\n\n对应未来可能的支持方案：对内置函数进行接口封装，等转换到新语言后，再由开发者实现这些接口。\n\n### 是否实现虚拟机？\n\n需要等到有精力的时间再考虑。\n\n### C++ 的支持程度？\n\nC++ 过于复杂，未来只会出现有限的 C++ 支持。\n\n### Go Context？\n\n是否要实现一些库去模拟 Context 的 Timeout Cancel？\n\n### EBNF\n\n### 其它 Suggestions\n\n#### Notes\n\nfrom [雾色](https://www.zhihu.com/people/yunlongyun)\n\n\u003e 为什么要编程语言转编程语言呢？如果可以从伪代码快速转化成编程语言不是也可以吗？并且这种抽象层次是比较稳定的。我们缺少伪代码转换成任何编程语言的工具。就像智能提示，我们可以把伪代码分解成细粒度，每个伪代码的名词都可以在网络库中找到对象，动词有方法，形容词有属性，再通过逻辑组织起来，每个细粒度的对象和逻辑都能被转换成任何编程语言。\n\n\u003e 我的意思是建立通用语言的标准，并尝试建立其中一门主流语言的对象库，甚至是脱离对象的通用方法和通用属性，在类似vscode这种编辑器中提供伪代码到对象或者函数的接口，每个人都能发布他的一个函数、一个对象、一个通用方法、一个通用属性到这个网络上的平台，其它人写伪代码时就可以直接提示出他选择的语言相关的对象、函数或者方法了。这样算不算实现了跨语言呢。把语言转换留给编程者去做，而这边只是提供一个平台、标准、接口或者编辑器插件。就像超强的tabnine。\n\n\u003e 可以把你伪代码中的任意一个词，给出许多（开源实时添加的）智能提示，比如我要实现一个算法，让篮子里的苹果增加一个。\n通过nlp分词并解析出词性，再给出对应的提示，篮子、苹果的对象，增加这个方法，一个这个数词可能是调用方法的循环次数。到最后自己需要的是组织，并且实现网络提示接口中没有的对象和方法，并自动上传。粒度可以是自由的，可以实现一个复杂的功能，可以实现一个简单点方法。将这种方法按照业务领域或者主题来划分。\n\n\nfrom [灵剑](https://www.zhihu.com/people/ling-jian-94)\n\n\u003e 简单听完有一些很深切的疑问：1. 不同语言的解析模型就不一样，正则表达式解析语法树这样的想法会不会太naive了一点？比如说C++的语法纯粹就是上下文相关的，a\u003cb,c\u003ed这样的结构有多义性，不可能单纯通过文法变成语法树；再比如说Python的语法跟缩进层级是有关的。2. 能变成语法树不代表就能做相互转码，首先不同语言的功能不一样，虽然说图灵完备的语言原则上都可以相互表达，但是这个相互转化的过程本身可能代价会超乎想象，甚至不得不以某种类似于虚拟机解释执行的方式运行；其次，标准库差异的问题难以解决，操作系统API之类的更难。更不要说跟第三方库二进制连接的问题了。\n\n\n\n"},"__N_SSG":true},"page":"/","query":{},"buildId":"GbhjyIAuq6jffrUmi3BnL","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-cc012b2e01d4498070bf.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.483e8dd6d267baea9145.js" async=""></script><script src="/_next/static/chunks/75d0fbb1153454ef8e9bfd327d44080552bdc54e.f4626cef716ce67a0fe6.js" async=""></script><script src="/_next/static/chunks/pages/_app-a8b90a3cdbfa2866f49b.js" async=""></script><script src="/_next/static/chunks/9f1dc3fa6ebb549af7417cdbef76437df99013dc.cbcaf4c8961f33298072.js" async=""></script><script src="/_next/static/chunks/pages/index-b5e7fb573515c411b860.js" async=""></script><script src="/_next/static/GbhjyIAuq6jffrUmi3BnL/_buildManifest.js" async=""></script><script src="/_next/static/GbhjyIAuq6jffrUmi3BnL/_ssgManifest.js" async=""></script></body></html>